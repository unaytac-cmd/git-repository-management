#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üß™ Running test suite before push..."

# Run JavaScript/TypeScript tests
echo "üì¶ Running JavaScript tests..."
npm run test:js
JS_EXIT_CODE=$?

if [ $JS_EXIT_CODE -ne 0 ]; then
  echo "‚ùå JavaScript tests failed"
  exit 1
fi
echo "‚úÖ JavaScript tests passed"

# Run Python tests if pytest is available
if command -v pytest >/dev/null 2>&1; then
  echo "üêç Running Python tests..."
  npm run test:py
  PY_EXIT_CODE=$?
  
  if [ $PY_EXIT_CODE -ne 0 ]; then
    echo "‚ö†Ô∏è  Python tests had issues, but continuing..."
  else
    echo "‚úÖ Python tests passed"
  fi
else
  echo "‚ö†Ô∏è  pytest not found. Skipping Python tests..."
  echo "   Install with: pip install pytest"
fi

echo "‚úÖ All tests passed! Pushing to remote..."
